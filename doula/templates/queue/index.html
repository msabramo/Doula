{% extends 'layouts/base.html' %}
{% import 'queue/queued_item.html' as queued_item_tmpl %}

{% block content %}
<div class="title-bar clearfix">
    <h2>Queue</h2>
</div>

<ul class="sort_by unstyled">
    <li>
        <a class="sort_by" data-val="all" href="/queue?sort_by=all&filter_by=alljobs">
            All
        </a>
    </li>
    <li>
        <a class="sort_by" data-val="queued" href="/queue?sort_by=queued&filter_by=alljobs">
            Queued
        </a>
    </li>
    <li>
        <a class="sort_by" data-val="complete" href="/queue?sort_by=complete&filter_by=alljobs">
            Complete
        </a>
    </li>
    <li>
        <a class="sort_by" data-val="failed" href="/queue?sort_by=failed&filter_by=alljobs">
            Failed
        </a>
    </li>
    <li>|</li>
    <li>
        <a class="filter_by" data-val="alljobs" href="/queue?filter_by=alljobs">
            All Jobs
        </a>
    </li>
    <li>
        <a class="filter_by" data-val="myjobs" href="/queue?filter_by=myjobs">
            My Jobs
        </a>
    </li>
</ul>

<div class="queued_items">
    <div>
        <h5></h5>
    </div>
    <div id="queue-jobs">
    {% set items = [] %}
    {% for queued_item in queued_items %}
    	{% if items.append(1) %}{% endif %}
        {{ queued_item_tmpl.render_queued_item(queued_item) }}
    {% endfor %}
    {% if items|length == 0 %}
    	<div class="alert">
            <p>No queue items</p>
    	</div>
    {% endif %}
    </div>
</div>
<script>

var __queueFilters = {
  "sortBy": {% if request.params.get('sort_by') %}
                "{{request.params.get('sort_by')}}"
              {% else %}
                "all"
              {% endif %},
  "filterBy": {% if request.params.get('filter_by') %}
                "{{request.params.get('filter_by')}}"
              {% else %}
                "alljobs"
              {% endif %},
  "service": false,
  "jobsStartedAfter": {{jobs_started_after}}
};
</script>
{% endblock %}
{% block scripts %}
{{ [
'/js/common/util.js',
'/js/common/queue.js'
]|js_script|safe }}
{% endblock %}