{% extends 'layouts/base.html' %}
{% block content %}
<div class="title">
	<h2>{{ service.name }} on {{ site.name|upper }}</h2>
</div>
<div>
<div class="well">
  <a id="push-to-test-site" class="btn sm-btn" href="#">
  <!-- release to test site needs a modal -->
  <i class="icon-chevron-right icon-black"></i> Release to Test Site</a>
  <!-- add new version to this service -->
  <a id="add-pckg" class="btn sm-btn-success" href="#">
  <i class="icon-plus icon-white"></i> Add New Version</a>
</div>

<!-- service_queue_status.html here -->

<table class="table table-striped">
  <thead>
    <tr>
      <th>Package</th>
      <th>Version</th>
    </tr>
  </thead>
  <tbody>
    <!-- our packages first, the ones with the github repo data -->
    {% for pckg in service.packages|sort(attribute='name') %}
    {% if pckg.get_github_info() %}
    <tr>
      <td>{{ pckg.name }} {{ pckg.version['version'] }}</td>
      <td>
        <select id="select01">
          <option value="remove">Remove package</option>

          {% for version in pckg.get_versions()|sort(reverse=True, case_sensitive=False) %}
            <option value="{{ version }}"
            {% if pckg.version == version %}selected="selected"{% endif %} >
              {{ version }}
            </option>
          {% endfor %}
        </select>
        <a class="btn sm-btn-success new-version-btn" data-name="{{pckg.name}}" href="#">
          <i class="icon-chevron-right icon-white"></i> New Version
        </a>
      </td>
    </tr>
    {% endif %}
    {% endfor %}

    <!-- packages without github info, alextodo, hide this by default -->
    {# do we want to only show the other dependencies or should you be able to change them? what else can we change?
    {% for pckg in service.packages|sort(attribute='name') %}
    {% if not pckg.get_github_info() %}
    <tr>
      <td>{{ pckg.name }} {{ pckg.version['version'] }}</td>
      <td>
        <select id="select01">
          <option value="remove">Remove package</option>

          {% for version in pckg.get_versions()|sort(reverse=True, case_sensitive=False) %}
            <option value="{{ version }}"
            {% if pckg.version == version %}selected="selected"{% endif %} >
              {{ version }}
            </option>
          {% endfor %}
        </select>
      </td>
    </tr>
    {% endif %}
    {% endfor %}
    #}
  </tbody>
</table>
</div>

<!-- all the packages on cheese prism not in this service -->
<div id="add-packages" class="modal hide">
  <!-- fill in -->
</div>
<div id="push-to-cheese-modal" class="modal hide">
  <!-- fill in -->
</div>
{% endblock %}

{% block scripts %}
<script>
var __service = {{service_json|safe}};
</script>
<script language="javascript" type="text/javascript" src=""></script>
<script language="javascript" type="text/javascript" src=""></script>
{{ [
'/js/common/util.js',
'/js/services/serv_data.js',
'/js/services/serv_env.js'
]|js_script|safe }}
{% endblock %}